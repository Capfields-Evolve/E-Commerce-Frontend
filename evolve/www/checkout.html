<!doctype html>
<html lang="en" class="pink-theme">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no, viewport-fit=cover, user-scalable=no">
    <meta name="description" content="">
    <meta name="author" content="Maxartkiller">

    <title>Checkout Â· Evolve</title>

    <!-- Material design icons CSS -->
    <link rel="stylesheet" href="vendor/materializeicon/material-icons.css">

    <!-- Roboto fonts CSS -->
    <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&amp;display=swap" rel="stylesheet">

    <!-- Bootstrap core CSS -->
    <link href="vendor/bootstrap-4.3.1/css/bootstrap.min.css" rel="stylesheet">

    <!-- Swiper CSS -->
    <link href="vendor/swiper/css/swiper.min.css" rel="stylesheet">

    <!-- Chosen multiselect CSS -->
    <link href="vendor/chosen_v1.8.7/chosen.min.css" rel="stylesheet">

    <!-- nouislider CSS -->
    <link href="vendor/nouislider/nouislider.min.css" rel="stylesheet">

    <!-- Custom styles for this template -->
    <link href="css/style.css" rel="stylesheet">
</head>

<body>
    <div class="row no-gutters vh-100 loader-screen">
        <div class="col align-self-center text-white text-center">
            <img src="img/logo.png" height="50px" alt="logo">
            <h3><span class="font-weight-light">Capfields</span>Evolve</h3>
            <div class="laoderhorizontal">
                <div></div>
                <div></div>
                <div></div>
                <div></div>
            </div>
        </div>
    </div>
    <div class="sidebar">
        <div class="text-center">
            <div class="figure-menu shadow">
                <figure><img src="img/userpic.png" alt=""></figure>
            </div>
            <h5 class="mb-1" id="customerName"></h5>
            <!--<p class="text-mute small">Abuja, Nigeria</p>-->
        </div>
        <br>
        <div class="row mx-0">
            <div class="col">
                <div class="card mb-3 border-0 shadow-sm bg-template-light">
                    <div class="card-body">
                        <div class="row">
                            <div class="col">
                                <p class="text-secondary small mb-0">Available Balance</p>
                                <h6 class="text-dark my-0" id="walletBalance"></h6>
                            </div>
                            <div class="col-auto">
                                <a href="fundwallet.html"><button class="btn btn-default button-rounded-36 shadow"><i class="material-icons">add</i></button></a>
                            </div>
                        </div>
                    </div>
                </div>
                <h5 class="subtitle text-uppercase"><span>Menu</span></h5>
                <div class="list-group main-menu">
                    <a href="index.html" class="list-group-item list-group-item-action active">Home</a>
                    <a href="notification.html" class="list-group-item list-group-item-action">Notification <span class="badge badge-dark text-white" id="notCounter"></span></a>
                    <a href="transfer.html" class="list-group-item list-group-item-action">Wallet Transfer</a>
                    <a href="vendor.html" class="list-group-item list-group-item-action">Producers</a>
                    <a href="farmonline.html" class="list-group-item list-group-item-action">Farm online</a>
                    <a href="my-order.html" class="list-group-item list-group-item-action">My Order</a>
                    <a href="profile.html" class="list-group-item list-group-item-action">My Profile</a>
                    <a href="setting.html" class="list-group-item list-group-item-action">Settings</a>
                    <a href="#" id="shareBtn" class="list-group-item list-group-item-action">Share App</a>
                    <a href="#" onclick="logout()" class="list-group-item list-group-item-action mt-4">Logout</a>
                </div>
            </div>
        </div>

    </div>
    <div class="wrapper">
        <div class="header">
            <div class="row no-gutters">
                <div class="col-auto">
                    <button class="btn  btn-link text-dark menu-btn"><img src="img/menu.png" alt=""><span class="new-notification"></span></button>
                </div>
                <div class="col text-center"><img src="img/logo-header.png" alt="" class="header-logo"></div>
                <div class="col-auto">
                    <a href="profile.html" class="btn  btn-link text-dark"><i class="material-icons">account_circle</i></a>
                </div>
            </div>
        </div>
        <div class="container">
            <p style="font-weight: bold;font-size:20px;text-align:center;margin-top:20px;">NOTE: This delivery fee also includes your shopping service charge</p>
            <div class="card border-0 shadow-sm mt-3">
                <div class="card-body">
                    <div class="row">
                        <div class="col-4">
                            <p class="text-secondary mb-1 small">Price</p>
                            <h5 class="mb-0" id="totalAmount"></h5>
                        </div>
                        <div class="col-4 text-center">
                            <p class="text-secondary mb-1 small">Delivery Fee</p>
                            <h5 class="mb-0" id="charges"></h5>
                        </div>
                        <div class="col-4 text-right">
                            <p class="text-secondary mb-1 small">Total</p>
                            <h5 class="mb-0" id="total"></h5>
                        </div>
                    </div>
                </div>
            </div>
            <div class="card mb-4 border-0 shadow-sm border-top-dashed">
                <div class="card-body text-center">
                    <p class="text-secondary my-1">Payable</p>
                    <h3 class="mb-0" id="payable"></h3><br>
                </div>
            </div>
            <div class="self hidden">
                <p style="font-size: 12px; color: grey" align="center">Please Pick up from <span id="shoploc"></span>, our agent will call you shortly. </p>
                <!--<input type="text" id="pickuploc" class="form-control" placeholder="Pickup location">-->
            </div>
            <div class="system">
                <div class="address">
                    <a href="address.html" class="btn btn-lg btn-default text-white btn-rounded shadow" style="text-transform: none;border-radius:45px;padding:7px;font-size: 13px">Change delivery address</a>
                </div><br><br>

                <div class="row podpay hidden">
                    <center>
                        <div class="card shadow" style="height: 200px;border:none;width:90%;text-align: center;">
                            <div class="card-body">

                                <img src="img/cancel.png" height="20" alt="cancel" style="margin-bottom:20px;float:right;margin-left:10px;" onclick="hidePod()">
                                <p align="center" style="margin-top:40px;">Select how you intend to pay when your order is delivered to you.</p>
                                <div class="row">
                                    <div class="col-4">
                                        <button onclick="podCard()" style="width:100%;background-color:whitesmoke;" id="podcard" class="btn btn-light">Card</button>
                                    </div>
                                    <div class="col-4">
                                        <button onclick="podTransfer()" style="width:100%;background-color:whitesmoke;" id="podtransfer" class="btn btn-light">Transfer</button>
                                    </div>
                                    <div class="col-4">
                                        <button onclick="podCash()" style="width:100%;background-color:whitesmoke;" id="podcash" class="btn btn-light">Cash</button>
                                    </div>
                                </div>

                            </div>
                        </div>
                    </center>
                </div>
                <br>
                <div class="nonpod">
                    <p class="text-center text-secondary mb-0">Pay with</p>

                    <div class="btn-group mt-4 w-100" style="width:100%" role="group" aria-label="Basic example">
                        <input type="hidden" id="amount">
                        <input type="hidden" id="cartcode">
                        <button onclick="payWithCard()" style="width:50%" class="btn btn-light active cardbtn">Credit Card</button>
                        <button onclick="showWallet()" style="width:50%" class="btn btn-light walletbtn">Wallet</button>

                    </div>
                    <div class="btn-group mt-4 w-100" role="group" aria-label="Basic example">
                        <button class="btn btn-light active transferbtn" style="width:50%" onclick="transfer()">Transfer</button>
                        <button class="btn btn-light flexbtn" style="width:50%" onclick="showFlex()">Flex</button>

                    </div><br>
                    <div class="row" style="margin-top:10px;">
                        <div class="col-12">
                            <div class="pod">
                                <button class="btn btn-lg btn-default text-white btn-block btn-rounded shadow" id="podcard" onclick="podCard()"><span>Pay On Delivery</span><i class="material-icons">arrow_forward</i></button>
                            </div>
                        </div>
                    </div><br>
                    <div class="transfer shadow hidden" style="padding:10px">
                        <h6 align="center">Account Details</h6>
                        <div class="row">
                            <div class="col-6">Account Name</div>
                            <div class="col-6"><strong>Capfields Nig Ltd</strong></div>
                            <div class="col-6">Account Number</div>
                            <div class="col-6"><strong>1019049321</strong></div><br>
                            <div class="col-6">Bank</div>
                            <div class="col-6"><strong>UBA</strong></div>

                            <div style="border-bottom:1px solid grey;width:320px;margin-left:15px;margin-bottom: 10px;margin-top: 10px;"></div>

                            <div class="col-12">
                                <p align="center" style="font-weight: 600;">Upload Payment Receipt</p>
                                <form action="" id="uploadimage" method="post" enctype="multipart/form-data">
                                    <input type="hidden" name="email" id="email">
                                    <input type="hidden" name="token" id="token">
                                    <input type="file" class="form-control" name="pic">
                            </div>
                            <div class="col-12"><button type="submit" id="uploadBtn" class="btn btn-primary shadow rounded btn-block" style="margin-top:5px">Submit</button></div>
                            </form>
                        </div><br>
                        <button class="btn btn-default btn-block shadow submitorder hidden" id="payWithBankTransfer">Submit Order</button>
                    </div>
                    <div class="cardpayment hidden">
                        <div class="row">
                            <div class="col-12">
                                <button class="btn btn-success btn-block btn-rounded shadow-sm" onclick="makePayment()">Pay with Flutterwave</button>
                            </div>
                        </div><br>
                        <div class="row">
                            <div class="col-12">
                                <button class="btn btn-primary btn-block btn-rounded shadow-sm" onclick="showStack()">Pay with Paystack</button>
                            </div>
                        </div>
                        <div class="paystack hidden">
                            <div class="row">
                                <div class="col-12">
                                    <div class="form-group">
                                        <label for="">Card Number</label>
                                        <input type="number" class="form-control" id="cardno">
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-3">
                                    <div class="form-group">
                                        <label for="">MM</label>
                                        <input type="number" class="form-control" id="expmnt">
                                    </div>
                                </div>
                                <div class="col-3">
                                    <div class="form-group">
                                        <label for="YY">YY</label>
                                        <input type="number" class="form-control" id="expyear">
                                    </div>
                                </div>
                                <div class="col-6">
                                    <div class="form-group">
                                        <label for="">CVV</label>
                                        <input type="number" class="form-control" id="cvv">
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-12">
                                    <div class="form-group">
                                        <label for="">Card Holder Name</label>
                                        <input type="text" class="form-control" id="cardname">
                                    </div>
                                </div>
                            </div>
                            <button class="btn btn-success btn-block shadow" id="payMoney">PAY</button>
                            <p id="resp"></p>
                        </div>
                    </div>
                    <!--<a href="thankyou.html" class="btn btn-lg btn-default text-white btn-block btn-rounded shadow"><span>Pay Now</span><i class="material-icons">arrow_forward</i></a>-->
                    <br>
                    <button class="btn btn-lg btn-default text-white btn-block btn-rounded shadow wallet hidden" id="payWithWallet"><span>Pay with Wallet</span><i class="material-icons">payment</i></button>
                    <button class="btn btn-lg btn-default text-white btn-block btn-rounded shadow flex hidden" id="payWithFlex"><span>Pay with Flex</span><i class="material-icons">payment</i></button>
                    <center>
                        <p class="text-muted">Don't want it delivered right away? Please select from any of the options below and pay</p>
                    </center><br>
                    <button style="font-size: 14px;" class="btn btn-default btn-rounded text-white btn-block btn-lg shadow selfbtn" id="selfPickUp">Self Pickup</button>
                    <a href="schedule-order.html" class="btn btn-lg btn-default text-white btn-block btn-rounded shadow schedule"><span>Schedule Delivery for Later</span><i class="material-icons">arrow_forward</i></a>


                    <br>
                </div>
            </div>
        </div>
        <div class="footer">
            <div class="no-gutters">
                <div class="col-auto mx-auto">
                    <div class="row no-gutters justify-content-center">
                        <div class="col-auto">
                            <a href="index.html" class="btn btn-link-default active">
                                <i class="material-icons">store_mall_directory</i>
                            </a>
                            <center>
                                <p class="text-mute" style="font-size: 10px; margin-top: -27px;opacity:0.5;">Home</p>
                            </center>
                        </div>
                        <div class="col-auto">
                            <a href="storetype.html" class="btn btn-link-default">
                                <i class="material-icons">toc</i>
                            </a>
                            <center>
                                <p class="text-mute" style="font-size: 10px; margin-top: -27px;opacity: 0.5">Category</p>
                            </center>
                        </div>
                        <div class="col-auto">
                            <a href="cart.html" class="btn btn-default shadow centerbutton">
                                <i class="material-icons">local_mall</i>
                            </a>
                            <center>
                                <p class="text-mute" style="font-size: 10px; margin-top: -6px;opacity: 0.5">Cart</p>
                            </center>
                        </div>
                        <div class="col-auto">
                            <a href="location.html" class="btn btn-link-default">
                                <i class="material-icons">room</i>
                            </a>
                            <center>
                                <p class="text-mute" style="font-size: 10px; margin-top: -27px;opacity: 0.5">Location</p>
                            </center>
                        </div>
                        <div class="col-auto">
                            <a href="profile.html" class="btn btn-link-default">
                                <i class="material-icons">account_circle</i>
                            </a>
                            <center>
                                <p class="text-mute" style="font-size: 10px; margin-top: -27px; opacity: 0.5"> Profile</p>
                            </center>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- jquery, popper and bootstrap js -->
    <script src="js/jquery-3.3.1.min.js"></script>
    <script src="js/popper.min.js"></script>
    <script src="vendor/bootstrap-4.3.1/js/bootstrap.min.js"></script>

    <!-- swiper js -->
    <script src="vendor/swiper/js/swiper.min.js"></script>

    <!-- nouislider js -->
    <script src="vendor/nouislider/nouislider.min.js"></script>

    <!-- chosen multiselect js -->
    <script src="vendor/chosen_v1.8.7/chosen.jquery.min.js"></script>

    <!-- template custom js -->
    <script src="https://kit.fontawesome.com/71ba3dee2b.js" crossorigin="anonymous"></script>
    <script src="https://checkout.flutterwave.com/v3.js"></script>
    <script src="js/main.js"></script>
    <script src="js/script.js"></script>
    <script src="login.js"></script>
    <script src="js/profile.js"></script>
    <script src="js/notification.js"></script>
    <script type="text/javascript" src="cordova.js"></script>
    <script src="checkout.js"></script>
    <script src="js/share.js"></script>
    <!-- page level script -->
    <script>
        document.getElementById("email").value = email;
        document.getElementById("token").value = token;

        function payWithCard() {
            $(".cardpayment").toggleClass("hidden");
        }

        function checkPodStat() {
            $.ajax({
                url: "https://evolve.capfields.com.ng/user_app/podstat.php",
                type: "POST",
                headers: {
                    Accept: 'application/json'
                },
                success: function(res) {
                    console.log(res)
                    if (res.pod === 'true') {
                        $(".pod").removeClass("hidden");
                    } else if (res.pod === 'false') {
                        $(".pod").addClass("hidden");
                    } else {
                        console.log('pod status');
                    }
                }
            })
        }
        window.load = checkPodStat();

        function transfer() {
            $(".transfer").toggleClass("hidden");
            $(".wallet").addClass("hidden");
            $(".schedule").toggleClass("hidden");
            $(".flex").addClass("hidden");
        }

        function showWallet() {
            $(".wallet").toggleClass("hidden");
            $(".flex").addClass("hidden");
        }

        function showFlex() {
            $(".flex").toggleClass("hidden");
            $(".wallet").addClass("hidden");
        }

        function showStack() {
            $(".paystack").toggleClass("hidden");
        }

        function selfpickup() {
            $(".self").toggleClass("hidden");
            $(".system").toggleClass("hidden")
        }

        function showPod() {
            $(".podpay").toggleClass("hidden");
            $(".nonpod").toggleClass("hidden");
        }

        function hidePod() {
            $(".podpay").toggleClass("hidden");
            $(".nonpod").toggleClass("hidden");
        }
        console.log(email)
            //selfpickup
        $("#selfPickUp").click(function(e) {
            e.preventDefault();
            alert('Only wallet, card and flex are the payment methods allowed for self pickup')
            $.ajax({
                url: "https://evolve.capfields.com.ng/user_app/self.php",
                type: "POST",
                headers: {
                    Accept: 'application/json'
                },
                data: {
                    email: email,
                    token: token
                },
                success: function(res) {
                    console.log(res)
                    msg = res.message;
                    if (msg == 'success') {
                        location.href = 'checkout.html';
                    }
                },
                error: function(res) {
                    console.log(res)
                }
            });

        })
        $.ajax({
            url: "https://evolve.capfields.com.ng/user_app/showcheckout.php",
            type: "POST",
            headers: {
                Accept: 'application/json'
            },
            data: {
                email: email,
                token: token
            },
            success: function(res) {
                console.log(res)
                amount = res.amount;
                if (amount == null) {
                    location.replace('index.html');
                }
                charges = res.charges;
                total = res.total;
                cartcode = res.cartcode;
                shoploc = res.shoploc;
                pickup = res.pickup;
                if (pickup == 'self') {
                    $(".schedule").addClass("hidden");
                    $(".transferbtn").addClass("hidden");
                }
                if (pickup == 'self') {
                    $(".cardbtn").removeClass("hidden");
                }

                if (total > 30000) {
                    $(".pod").addClass("hidden");
                }
                $("#shoploc").text(shoploc);
                document.getElementById("cartcode").value = cartcode;
                $("#totalAmount").append('â¦', amount).digits();
                $("#charges").append('â¦', charges).digits();
                $("#total").append('â¦', total).digits();
                $("#payable").append('â¦', total).digits();
                document.getElementById("amount").value = total;
            },
            error: function(res) {
                console.log(res)
            }
        });

        function podCard() {
            amount = $("#amount").val();
            cartcode = $("#cartcode").val();
            if (amount === "") {
                alert('Error occurred');
            } else if (cartcode === "") {
                alert('Error occurred');
            } else if (amount > 30000) {
                alert('Option not available');
            } else {
                document.getElementById("podcard").innerHTML = 'Loading';
                $.ajax({
                    url: "https://evolve.capfields.com.ng/user_app/podpay.php",
                    type: "POST",
                    headers: {
                        Accept: 'application/json'
                    },
                    data: {
                        email: email,
                        token: token,
                        amount: amount,
                        cartcode: cartcode
                    },
                    success: function(res) {
                        console.log(res)
                        msg = res.message;
                        if (msg == 'success') {
                            window.location = 'submit-order.html';
                        } else {
                            alert(msg);
                            document.getElementById("podcard").innerHTML = '<span>Pay On Delivery</span><i class="material-icons">arrow_forward</i>';
                        }
                    },
                    error: function(res) {
                        console.log(res)
                        alert('Error in connection');
                        document.getElementById("podcard").innerHTML = '<span>Pay On Delivery</span><i class="material-icons">arrow_forward</i>';
                    }
                });
            }
        }

        function podCash() {
            amount = $("#amount").val();
            cartcode = $("#cartcode").val();
            if (amount === "") {
                alert('Error occurred');
            } else if (cartcode === "") {
                alert('Error occurred');
            } else if (amount > 30000) {
                alert('Option not available');
            } else {
                document.getElementById("podcash").innerHTML = 'Loading';
                $.ajax({
                    url: "https://evolve.capfields.com.ng/user_app/podcash.php",
                    type: "POST",
                    headers: {
                        Accept: 'application/json'
                    },
                    data: {
                        email: email,
                        token: token,
                        amount: amount,
                        cartcode: cartcode
                    },
                    success: function(res) {
                        console.log(res)
                        msg = res.message;
                        if (msg == 'success') {
                            window.location = 'submit-order.html';
                        } else {
                            alert(msg);
                            document.getElementById("podcash").innerHTML = 'cash';
                        }
                    },
                    error: function(res) {
                        console.log(res)
                        alert('Error in connection');
                        document.getElementById("podcash").innerHTML = 'cash';
                    }
                });
            }
        }

        function podTransfer() {
            amount = $("#amount").val();
            cartcode = $("#cartcode").val();
            if (amount === "") {
                alert('Error occurred');
            } else if (cartcode === "") {
                alert('Error occurred');
            } else if (amount > 30000) {
                alert('Option not available');
            } else {
                document.getElementById("podtransfer").innerHTML = 'Loading';
                $.ajax({
                    url: "https://evolve.capfields.com.ng/user_app/podtransfer.php",
                    type: "POST",
                    headers: {
                        Accept: 'application/json'
                    },
                    data: {
                        email: email,
                        token: token,
                        amount: amount,
                        cartcode: cartcode
                    },
                    success: function(res) {
                        console.log(res)
                        msg = res.message;
                        if (msg == 'success') {
                            window.location = 'submit-order.html';
                        } else {
                            alert(msg);
                            document.getElementById("podtransfer").innerHTML = 'transfer';
                        }
                    },
                    error: function(res) {
                        console.log(res)
                        alert('Error in connection');
                        document.getElementById("podtransfer").innerHTML = 'transfer';
                    }
                });
            }
        }

        $(document).ready(function(e) {
            $("#uploadimage").on('submit', (function(e) {
                document.getElementById("uploadBtn").innerHTML = '<i class="fa fa-circle-o-notch fa-spin" style="font-size:25px"></i>';
                e.preventDefault();
                $.ajax({
                    url: "https://evolve.capfields.com.ng/user_app/uploadpayment.php", // Url to which the request is send
                    type: "POST", // Type of request to be send, called as method
                    data: new FormData(this), // Data sent to server, a set of key/value pairs (i.e. form fields and values)
                    contentType: false, // The content type used when sending data to the server.
                    cache: false, // To unable request pages to be cached
                    processData: false, // To send DOMDocument or non processed data file it is set to false
                    success: function(data) // A function to be called if request succeeds
                        {
                            console.log(data)
                            msg = data.message;
                            if (msg == 'success') {
                                alert('Payment proof uploaded successfully');
                                document.getElementById("uploadBtn").innerHTML = 'Submit';
                                location.href = 'index.html';
                            } else {
                                alert(msg);
                                document.getElementById("uploadBtn").innerHTML = 'Submit';
                            }
                        },
                    error: function(data) {
                        console.log(data)
                        alert('Error in connection')
                        document.getElementById("uploadBtn").innerHTML = 'Submit';
                    }
                });
            }));
        });

        $.ajax({
            url: "https://evolve.capfields.com.ng/user_app/checkpaymentstatus.php",
            type: "POST",
            headers: {
                Accept: 'application/json'
            },
            data: {
                email: email,
                token: token
            },
            success: function(res) {
                console.log(res)
                admin = res.admin;
                if (admin == 'approved') {
                    $(".submitorder").removeClass("hidden");
                    $(".address").addClass("hidden");
                    $(".selfbtn").addClass("hidden");
                }
            },
            error: function(res) {
                console.log(res)
            }
        });
        //function payWIthWallet() {
        $("#payWithWallet").click(function(e) {
            document.getElementById("payWithWallet").innerHTML = '<i class="fa fa-circle-o-notch fa-spin" style="font-size:25px"></i>';
            e.preventDefault();
            amount = $("#amount").val();
            code = $("#cartcode").val();
            if (amount == "") {
                alert('Error occurred');
                document.getElementById("payWithWallet").innerHTML = '<span>Pay with Wallet</span><i class="material-icons">payment</i>';
            } else if (code == "") {
                alert('Error processing your payment');
                document.getElementById("payWithWallet").innerHTML = '<span>Pay with Wallet</span><i class="material-icons">payment</i>';
            } else {
                $.ajax({
                    url: "https://evolve.capfields.com.ng/user_app/paywithwallet.php",
                    type: "POST",
                    headers: {
                        Accept: 'application/json'
                    },
                    data: {
                        email: email,
                        token: token,
                        amount: amount,
                        cartcode: code
                    },
                    success: function(res) {
                        console.log(res);
                        msg = res.message;
                        if (msg == 'success') {
                            window.location = 'submit-order.html';
                        } else {
                            alert(msg);
                            document.getElementById("payWithWallet").innerHTML = '<span>Pay with Wallet</span><i class="material-icons">payment</i>';
                        }
                    },
                    error: function(res) {
                        console.log(res);
                        alert('Error in connection');
                        document.getElementById("payWithWallet").innerHTML = '<span>Pay with Wallet</span><i class="material-icons">payment</i>';
                    }
                });
            }
        });

        $("#payWithBankTransfer").click(function(e) {
            document.getElementById("payWithBankTransfer").innerHTML = '<i class="fa fa-circle-o-notch fa-spin" style="font-size:25px"></i>';
            e.preventDefault();
            amount = $("#amount").val();
            code = $("#cartcode").val();
            if (amount == "") {
                alert('Error occurred');
                document.getElementById("payWithBankTransfer").innerHTML = 'Submit Order';
            } else if (code == "") {
                alert('Error processing your payment');
                document.getElementById("payWithBankTransfer").innerHTML = 'Submit Order';
            } else {
                $.ajax({
                    url: "https://evolve.capfields.com.ng/user_app/paywithtransfer.php",
                    type: "POST",
                    headers: {
                        Accept: 'application/json'
                    },
                    data: {
                        email: email,
                        token: token,
                        amount: amount,
                        cartcode: code
                    },
                    success: function(res) {
                        console.log(res);
                        msg = res.message;
                        if (msg == 'success') {
                            window.location = 'submit-order.html';
                        } else {
                            alert(msg);
                            document.getElementById("payWithBankTransfer").innerHTML = 'Submit Order';
                        }
                    },
                    error: function(res) {
                        console.log(res);
                        alert('Error in connection');
                        document.getElementById("payWithBankTransfer").innerHTML = 'Submit Order';
                    }
                });
            }
        });


        $("#payWithFlex").click(function(e) {
            document.getElementById("payWithFlex").innerHTML = '<i class="fa fa-circle-o-notch fa-spin" style="font-size:25px"></i>';
            e.preventDefault();
            amount = $("#amount").val();
            code = $("#cartcode").val();
            if (amount == "") {
                alert('Error occurred');
                document.getElementById("payWithFlex").innerHTML = '<span>Pay with Wallet</span><i class="material-icons">payment</i>';
            } else if (code == "") {
                alert('Error processing your payment');
                document.getElementById("payWithFlex").innerHTML = '<span>Pay with Wallet</span><i class="material-icons">payment</i>';
            } else {
                $.ajax({
                    url: "https://evolve.capfields.com.ng/user_app/paywithflex.php",
                    type: "POST",
                    headers: {
                        Accept: 'application/json'
                    },
                    data: {
                        email: email,
                        token: token,
                        amount: amount,
                        cartcode: code
                    },
                    success: function(res) {
                        console.log(res);
                        msg = res.message;
                        if (msg == 'success') {
                            window.location = 'submit-order.html';
                        } else {
                            alert(msg);
                            document.getElementById("payWithFlex").innerHTML = '<span>Pay with Flex</span><i class="material-icons">payment</i>';
                        }
                    },
                    error: function(res) {
                        console.log(res);
                        alert('Error in connection');
                        document.getElementById("payWithFlex").innerHTML = '<span>Pay with Flex</span><i class="material-icons">payment</i>';
                    }
                });
            }
        });

        function makePayment() {
            inputamount = $("#amount").val();
            code = $("#cartcode").val();
            if (inputamount == "") {
                alert('Enter amount');
            } else if (code == "") {
                alert('Error proccessing payment');
            } else {
                FlutterwaveCheckout({
                    public_key: "FLWPUBK-f129a6e0a499714b8d4cc9eb618fc994-X",
                    tx_ref: code,
                    amount: inputamount,
                    currency: "NGN",
                    country: "NG",
                    payment_options: "card",
                    customer: {
                        email: email,
                        phone_number: localStorage.getItem("phone"),
                        name: localStorage.getItem("custName"),
                    },
                    callback: function(data) { // specified callback function
                        console.log(data);
                        status = data.status;
                        if (status == 'successful') {
                            $.ajax({
                                url: "https://evolve.capfields.com.ng/user_app/paywithcard.php",
                                type: "POST",
                                headers: {
                                    Accept: 'application/json'
                                },
                                data: {
                                    email: email,
                                    token: token,
                                    amount: inputamount,
                                    cartcode: code,
                                    reference: data.flw_ref
                                },
                                success: function(res) {
                                    console.log(res)
                                    msg = res.message;
                                    if (msg == 'success') {
                                        window.location = 'submit-order.html';
                                    } else {
                                        alert(msg);
                                    }
                                },
                                error: function(res) {
                                    console.log(res)
                                    alert('Error occurred. Transaction reference: ' + data.flw_ref);
                                }
                            })
                        }
                    },
                    customizations: {
                        title: "Capfields Evolve",
                        description: "Payment for items in cart",
                        logo: "https://evolve.capfields.com.ng/user_app/img/logo.png",
                    },
                });
            }
        }

        function payWithPaystack() {
            inputamount = $("#amount").val();
            code = $("#cartcode").val();
            if (inputamount == "") {
                alert('Enter amount');
            } else if (code == "") {
                alert('Error proccessing payment');
            } else {
                amount = inputamount * 100;
                var handler = PaystackPop.setup({
                    key: 'pk_live_73bea53857da2959a95f98f6e41c070115bb74f2',
                    email: email,
                    amount: amount,
                    currency: "NGN",
                    ref: '' + Math.floor((Math.random() * 1000000000) + 1), // generates a pseudo-unique reference. Please replace with a reference you generated. Or remove the line entirely so our API will generate one for you
                    metadata: {
                        custom_fields: [{
                            display_name: "Mobile Number",
                            variable_name: "mobile_number",
                            value: "+2348012345678"
                        }]
                    },
                    callback: function(response) {
                        alert('success. transaction ref is ' + response.reference);
                        $.ajax({
                            url: "https://evolve.capfields.com.ng/user_app/paywithcard.php",
                            type: "POST",
                            headers: {
                                Accept: 'application/json'
                            },
                            data: {
                                email: email,
                                token: token,
                                amount: inputamount,
                                cartcode: code,
                                reference: response.reference
                            },
                            success: function(res) {
                                console.log(res)
                                msg = res.message;
                                if (msg == 'success') {
                                    window.location = 'submit-order.html';
                                } else {
                                    alert(msg);
                                }
                            },
                            error: function(res) {
                                console.log(res)
                                alert('Error occurred. Transaction reference: ' + response.reference);
                            }
                        })
                    },
                    onClose: function() {
                        alert('window closed');
                    }
                });
                handler.openIframe();
            }
        }

        //check bank payment
        $.ajax({
            url: "https://evolve.capfields.com.ng/user_app/check-transfer.php",
            type: "POST",
            headers: {
                Accept: 'application/json'
            },
            data: {
                email: email,
                token: token
            },
            success: function(res) {
                console.log(res)
                msg = res.message;
                if (msg == 'true') {
                    $(".cardbtn").addClass("hidden");
                    $(".walletbtn").addClass("hidden");
                    $(".flexbtn").addClass("hidden");
                    alert('Click on TRANSFER to submit order now . OR click SCHEDULE DELIVERY FOR LATER again then TRANSFER if you wish to schedule your order.');
                }
            },
            error: function(res) {
                console.log(res)
            }
        });
        /*$("document").ready(function() {
            function checkingOut() {
                amount = $("#amount").val();
                $.ajax({
                    url: "https://evolve.capfields.com.ng/user_app/checkout1.php",
                    type: "POST",
                    headers: {
                        Accept: 'application/json'
                    },
                    data: {
                        email: email,
                        token: token,
                        amount: amount
                    },
                    success: function(res) {
                        console.log(res)
                    },
                    error: function(res) {
                        console.log(res)
                    }
                });
            }
            //setInterval(checkingOut, 3000);
        })*/
    </script>
</body>

</html>